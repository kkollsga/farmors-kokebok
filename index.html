<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, minimal-ui">
<title>Farmors Kokebok</title>
<!-- Progressive Web App -->
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Farmors Kokebok">
<link rel="apple-touch-icon" sizes="120x120" href="icons/kokebok-120.png">
<link rel="apple-touch-icon" sizes="152x152" href="icons/kokebok-152.png">
<link rel="apple-touch-icon" sizes="167x167" href="icons/kokebok-167.png">
<link rel="apple-touch-icon" sizes="180x180" href="icons/kokebok-180.png">
<link rel="apple-touch-icon" sizes="1024x1024" href="icons/kokebok-1024.png">
<!-- Favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="icons/kokebok-32.png">
<link rel="icon" type="image/png" sizes="48x48" href="icons/kokebok-48.png">
<link rel="icon" type="image/png" sizes="96x96" href="icons/kokebok-96.png">
<link rel="icon" type="image/png" sizes="192x192" href="icons/kokebok-192.png">
<!-- Favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="icons/kokebok-32.png">
<link rel="icon" type="image/png" sizes="48x48" href="icons/kokebok-48.png">
<link rel="icon" type="image/png" sizes="96x96" href="icons/kokebok-96.png">
<link rel="icon" type="image/png" sizes="192x192" href="icons/kokebok-192.png">
<meta name="msapplication-TileImage" content="icons/kokebok-144.png">
<meta name="msapplication-TileColor" content="#B45309">

<!-- Content Security Policy -->
<meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline'; object-src 'none';">

<link rel="stylesheet" href="tailwind.css">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Kalam:wght@400;700&display=swap" rel="stylesheet">
<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link rel="stylesheet" href="styles.css">
</head>
<body class="bg-gradient-to-br from-orange-50 via-amber-50 to-yellow-50 min-h-screen">
<!-- Header -->
<header class="safe-top">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <!-- Daily Farmor Image -->
        <div id="farmorImageContainer" class="flex justify-center mb-4 px-0.5">
            <div class="inline-block relative" style="max-width: min(720px, 100%);">
                <img src="" 
                     alt="Farmor" 
                     id="farmorImage"
                     class="block rounded-lg opacity-0 transition-opacity duration-500 shadow-md"
                     style="filter: sepia(0.15) contrast(1.05); max-width: 100%; max-height: 360px; width: auto; height: auto; object-fit: contain;">
                
                <!-- Subtle frame border -->
                <div class="absolute inset-0 border-2 border-gray-600/10 rounded-lg pointer-events-none"></div>
                
                <!-- Inner shadow for depth -->
                <div class="absolute inset-0 rounded-lg shadow-[inset_0_2px_4px_rgba(0,0,0,0.06)] pointer-events-none"></div>
            </div>
        </div>
        
        <!-- App Title -->
        <div class="flex justify-between items-center">
            <h1 id="appTitle" class="font-display text-3xl text-amber-800 w-full text-center"></h1>
        </div>
    </div>
</header>

<!-- Unified Search/Filter Bar -->
<div id="searchFilterContainer" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-2 relative z-30">
    <div id="unifiedGlassBar" class="relative rounded-xl bg-white border border-gray-200 overflow-visible w-full z-40">

        <!-- Content container -->
        <div class="relative flex items-center gap-2 px-3 py-2">
            <!-- Standard content -->
            <div id="standardContent" class="flex items-center gap-2 w-full min-w-0">
                <!-- Filter Button -->
                <button id="unifiedFilterBtn" class="flex items-center space-x-2 px-4 py-2 rounded-xl transition-all text-sm font-medium shrink-0 shadow-sm hover:shadow-md bg-white text-gray-700 hover:text-amber-600 border border-gray-200">
                    <i class="fas fa-filter transition-transform duration-200 active:scale-90"></i>
                    <span id="filterButtonText">Filter</span>
                    <span id="filterCount" class="bg-white/30 text-white text-xs px-1.5 py-0.5 rounded-full font-semibold hidden">0</span>
                </button>

                <!-- Filter Pills Container -->
                <div id="filterPillsContainer" class="flex gap-2 overflow-hidden whitespace-nowrap shrink-0">
                    <!-- Filter pills will be inserted here -->
                </div>

                <!-- Search Input -->
                <div id="searchInputContainer" class="flex items-center gap-2 px-3 py-1.5 rounded-xl bg-white hover:bg-amber-50/20 transition-all border-gray-200 border flex-1 min-w-0 focus-within:border-amber-400 focus-within:bg-amber-50/10">
                    <i class="fas fa-search text-amber-700 text-sm"></i>
                    <input type="text" id="unifiedSearchInput" placeholder="Search recipes..." class="bg-transparent outline-none text-amber-700 placeholder-gray-400 w-full font-normal focus:outline-none" style="font-size: 16px;">
                    <button id="clearSearchBtn" class="text-amber-700 hover:text-amber-800 transition-colors hidden">
                        <i class="fas fa-times text-sm"></i>
                    </button>
                </div>
            </div>

            <!-- Minimum content (hidden by default) -->
            <div id="minimumContent" class="flex items-center gap-1.5 hidden px-3 py-2">
                <!-- Filter counter (when search and filters are both active) -->
                <div id="filterCounter" class="inline-flex items-center gap-1 text-amber-700 text-sm hidden cursor-pointer hover:text-amber-800 transition-colors mr-1 ml-2">
                    <i class="fas fa-filter text-xs"></i>
                    <span id="filterCounterText" class="font-medium text-xs">0</span>
                </div>

                <!-- Search pill -->
                <div id="searchPill" class="inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-sm transition-all shadow-sm bg-white text-amber-700 border border-gray-200 hidden">
                    <i class="fas fa-search text-sm"></i>
                    <span id="searchPillText"></span>
                    <button id="clearSearchPill" class="ml-1 hover:text-amber-800 flex-shrink-0">
                        <i class="fas fa-times text-sm"></i>
                    </button>
                </div>

                <!-- Filter pill -->
                <div id="filterPill" class="inline-flex items-center gap-1 px-3 py-1.5 rounded-full text-sm transition-all shadow-sm bg-gradient-to-r from-amber-500 to-amber-600 text-white hidden">
                    <i class="fas fa-filter text-sm"></i>
                    <span id="filterPillText"></span>
                    <button id="clearFilterPill" class="ml-1 hover:opacity-70 flex-shrink-0">
                        <i class="fas fa-times text-sm"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Filter dropdown menu -->
        <div id="unifiedFilterMenu" class="absolute top-full left-0 mt-2 hidden z-50">
            <!-- Filter menu content will be inserted here -->
        </div>

        <!-- Active filters dropdown -->
        <div id="unifiedActiveFiltersMenu" class="absolute top-full left-0 mt-2 hidden z-50">
            <!-- Active filters menu content will be inserted here -->
        </div>
    </div>
</div>

<!-- Sort Selector (moved to separate section) -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
    <div class="flex items-center gap-4">
        <span class="text-sm font-medium text-gray-600">Sort:</span>
        <button data-sort="recommendation" 
                onclick="recipeApp.filterManager.changeSortOrder('recommendation')"
                class="p-2 rounded-lg bg-amber-500 text-white transition-all duration-200"
                title="">
            <i class="fas fa-thumbs-up"></i>
        </button>
        <button data-sort="recipebook" 
                onclick="recipeApp.filterManager.changeSortOrder('recipebook')"
                class="p-2 rounded-lg text-gray-700 hover:text-amber-600 transition-all duration-200"
                title="">
            <i class="fas fa-book"></i>
        </button>
        <button data-sort="alphabetical" 
                onclick="recipeApp.filterManager.changeSortOrder('alphabetical')"
                class="p-2 rounded-lg text-gray-700 hover:text-amber-600 transition-all duration-200"
                title="">
            <i class="fas fa-sort-alpha-down"></i>
        </button>
        <button data-sort="madecount" 
                onclick="recipeApp.filterManager.changeSortOrder('madecount')"
                class="p-2 rounded-lg text-gray-700 hover:text-amber-600 transition-all duration-200"
                title="">
            <i class="fas fa-utensils"></i>
        </button>
        <button data-sort="rating" 
                onclick="recipeApp.filterManager.changeSortOrder('rating')"
                class="p-2 rounded-lg text-gray-700 hover:text-amber-600 transition-all duration-200"
                title="">
            <i class="fas fa-star"></i>
        </button>
        
        <!-- Copy URL Button (moved here from old filter bar) -->
        <button id="copyURLButton" 
                onclick="recipeApp.urlManager.copyToClipboard(recipeApp.urlManager.getShareableURL(), this)" 
                class="ml-auto text-xs text-gray-500 hover:text-amber-600 transition-all duration-200 font-medium px-3 py-1 rounded-lg">
            <i class="fas fa-copy sm:mr-1"></i>
            <span id="copyURLText" class="hidden sm:inline"></span>
        </button>
    </div>
</div>

<!-- Main Recipe Grid -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-6 pb-2 safe-bottom">
    <div id="recipeGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- Recipe cards will be inserted here -->
    </div>
</div>

<!-- Recipe Modal (unchanged) -->
<div id="recipeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="flex items-start justify-center min-h-screen sm:pt-8">
        <div class="bg-red sm:rounded-3xl max-w-5xl w-full sm:h-[92vh] modal-height-mobile flex flex-col overflow-hidden modal-content-mobile">
            <div id="modalContent" class="h-full flex flex-col overflow-y-auto">
                <!-- Recipe content will be inserted here -->
            </div>
        </div>
    </div>
</div>

<!-- Signature -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-2 mb-12 safe-bottom">
    <p class="text-right text-gray-500 text-xs">
        Fra <span class="signature-name text-gray-600 text-base">Kristian og Paula<br>de Figueiredo Kollsg√•rd</span>
    </p>
</div>
<script src="script.js"></script>
</body>
</html>